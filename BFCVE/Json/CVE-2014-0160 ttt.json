{"DefectWeakness":{"ClassType":"_INP","Cause":{"Type":"Code Defect","Name":"Missing Code","Comment":"in \u0027dtls1_process_heartbeat(SSL *s)\u0027"},"Operation":{"Name":"Verify","Comment":"length"},"Consequence":{"Type":"Data","Name":"Inconsistent Value","Comment":"\u0027payload\u0027"},"WeaknessAttributes":{"OperationAttribute":{},"OperandAttribute":[{}]},"Language":"C","File":"https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3#diff-6f954bc636343f76cc5f584e115159c89222b1b611fa0cac1059424e481b05b9L1463-L1465","Trace":"ssl /d1_both.c: 1462\r\nssl /t1_lib.c: 2591","Line":"ssl /d1_both.c: 1462\r\nssl /t1_lib.c: 2591","Class":"DVR"},"Weakness":[{"ClassType":"_MEM","Cause":{"Type":"Data","Name":"Wrong Size","Comment":"in \u0027memcpy(bp, pl, payload)\u0027"},"Operation":{"Name":"Reposition","Comment":"pointer"},"Consequence":{"Type":"Address","Name":"Over Bounds Pointer","Comment":"\u0027pl\u0027"},"WeaknessAttributes":{"OperationAttribute":{},"OperandAttribute":[{},{}]},"Language":"C","File":"https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487;\r\nhttps://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620","Trace":"ssl /d1_both.c: 1462, 1480\r\nssl /t1_lib.c: 2591, 2437","Line":"ssl /d1_both.c: 1480\r\nssl /t1_lib.c: 2437","Class":"MAD"},{"ClassType":"_MEM","Cause":{"Type":"Address","Name":"Over Bounds Pointer","Comment":"in \u0027memcpy(bp, pl, payload)\u0027"},"Operation":{"Name":"Read","Comment":"object"},"Consequence":{"Type":"Memory Corruption/Disclosure","Name":"Buffer Over-Read","Comment":"\u0027pl\u0027"},"WeaknessAttributes":{"OperationAttribute":{},"OperandAttribute":[{},{}]},"Language":"C","File":"https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487;\r\nhttps://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620","Trace":"ssl /d1_both.c: 1462, 1480\r\nssl /t1_lib.c: 2591, 2437","Line":"ssl /d1_both.c: 1480\r\nssl /t1_lib.c: 2437","Class":"MUS"}],"Failure":{"ClassType":"_FLR","Cause":{"Type":"Memory Corruption/Disclosure","Name":"Buffer Over-Read","Comment":"see also:\r\nhttps://git.openssl.org/?p=openssl.git;a=blob;f=ssl/t1_lib.c;h=c5c805cce286d12d81c5fdccfe9173d61a68ee82;hb=4817504d069b4c5082161b02a22116ad75f822b1"},"Failure":[{"FailureAttributes":null,"Class":"IEX"}]},"ID":"CVE-2014-0160","Title":"Heartbleed Heap Buffer Over-Read in OpenSSL v1.0.1 before v1.0.1g","Description":"Missing verification of \u0027payload\u0027  towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in \u0027memcpy()\u0027 leads to  a heap buffer over-read. If exploited, this can lead to exposure of sensitive information \u2013 confidentiality loss.\r\n\r\n//generated//\r\nMissing Code in \u0027dtls1_process_heartbeat(SSL *s)\u0027 to Range Verify length in Third-Party \u0027ssl /d1_both.c:1462\u0027 and \r\n\u0027ssl /t1_lib.c:2591\u0027 leads to Inconsistent Value \u0027payload\u0027\r\n\r\n, which propagates to Wrong Size in \u0027memcpy(bp, pl, payload)\u0027 Sequential pointer  Reposition in Third-Party ssl /d1_both.c:1487 and ssl /t1_lib.c:2620 resulting in  Heap Over Bounds Pointer \u0027pl\u0027\r\n\r\n, which propagates to Over Bounds Pointer in \u0027memcpy(bp, pl, payload)\u0027 Sequential object  Read in Third-Party ssl /d1_both.c:1487 and ssl /t1_lib.c:2620 resulting in  Heap Buffer Over-Read \u0027pl\u0027\r\n\r\n. If exploited this can lead to IEX.","Author":"Irena Bojanova, Carlos Galhardo","Date":"2023-02-10T11:16:21","Score":"5.0","Criteria":"openssl:openssl","BugReport":"https://www.seancassidy.me/diagnosis-of-the-openssl-heartbleed-bug.html","CodeWithBug":"https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/d1_both.c;h=0a84f957118afa9804451add380eca4719a9765e;hb=4817504d069b4c5082161b02a22116ad75f822b1","CodeWithFix":"https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3","CommitId":"96db9023b881d7cd9f379b0c154650d6c108e9a3"}