<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2022-37454" Title="XKCP" Site="" Bug="" Fix="" Author="Irena Bojanova" Date="2023-06-09T10:42:48">
  <DefectWeakness ClassType="_DAT" Class="TCM" Language="" File="Modules/_sha3/kcp/KeccakSponge.inc" Trace="" Line="203, 204">
    <Cause Comment="for all 64-it Windows, Linux, and macOS OSs" Type="Code Defect">Wrong Code</Cause>
    <Operation Comment="(partialBlock+instance-&gt;byteIOIndex&gt;rateInBytes), where both are 32-bit, should be (partialBlock&gt;rateInBytes - instance-&gt;byteIOIndex)">Calculate</Operation>
    <Consequence Comment="if partialBlock is large enough and instanceinstance-&gt;byteIOIndex in not zero" Type="Data">Wrap Around</Consequence>
    <Attributes>
      <Operation>
        <Attribute Comment="32-bit addition (+)" Type="Mechanism">Operator</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness ClassType="_DAT" Class="TCM" Language="" File="Modules/_sha3/kcp/KeccakSponge.inc" Trace="" Line="203, 204">
    <Cause Comment="a small value, while in fact it was a very large value" Type="Data">Wrong Argument</Cause>
    <Operation Comment="partialBlock+instance-&gt;byteIOIndex&gt;rateInBytes">Evaluate</Operation>
    <Consequence Comment="" Type="Data">Wrong Result</Consequence>
    <Attributes>
      <Operation />
    </Attributes>
  </Weakness>
  <Weakness ClassType="_MEM" Class="MUS" Language="" File="Modules/_sha3/kcp/KeccakSponge.inc" Trace="" Line="203, 204">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation>Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operation />
    </Attributes>
  </Weakness>
  <Failure ClassType="_FLR" Class="ACE" Language="" File="Modules/_sha3/kcp/KeccakSponge.inc" Trace="" Line="203, 204">
    <Cause Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Operation>ACE Operation</Operation>
    <Consequence Type="Address">RCE Consequence</Consequence>
    <Attributes>
      <Operation />
    </Attributes>
  </Failure>
</BFCVE>